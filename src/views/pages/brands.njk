{% extends "layouts/base.njk" %}

{% block bodyClass %}brands-page{% endblock %}

{% block content %}
<div class="brands min-h-screen bg-gray-50">
    <div class="container mx-auto px-4 py-8">
        {# Page Header #}
        <div class="text-center mb-12">
            <h1 class="text-4xl md:text-5xl font-bold text-gray-900 mb-4">
                {% if searchQuery %}
                <span class="text-primary-600">Search:</span> "{{ searchQuery }}"
                {% else %}
                All Brands
                {% endif %}
            </h1>
            <p class="text-xl text-gray-600 max-w-2xl mx-auto">
                Discover amazing brands and explore their collections of premium products.
            </p>
        </div>

        {# Search Box #}
        <div class="flex justify-center mb-12">
            <form class="w-full max-w-lg" method="GET" action="/brands">
                <div class="relative">
                    <input 
                        type="text" 
                        name="search" 
                        value="{{ searchQuery | default('') }}" 
                        placeholder="Search brands..." 
                        class="w-full px-4 py-3 pr-12 text-gray-900 bg-white border border-gray-300 rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-all duration-200"
                    >
                    <button type="submit" class="absolute right-3 top-1/2 transform -translate-y-1/2 p-1 text-gray-400 hover:text-primary-600 transition-colors duration-200">
                        <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="11" cy="11" r="8"></circle>
                            <path d="m21 21-4.35-4.35"></path>
                        </svg>
                    </button>
                </div>
            </form>
        </div>

        {# Brands Grid #}
        {% if brands and brands.length > 0 %}
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8 mb-12">
            {% for brand in brands %}
            <article class="card-tw group cursor-pointer transform hover:scale-105 transition-all duration-300 hover:shadow-strong">
                <a href="/products?brand={{ brand.slug }}" class="block h-full">
                    <div class="aspect-video overflow-hidden bg-gradient-to-br from-primary-100 to-secondary-100 flex items-center justify-center">
                        {% if brand.logo and brand.logo.url %}
                        <img 
                            src="{{ brand.logo.url }}"
                            alt="{{ brand.logo.alt | default(brand.name) }}"
                            loading="lazy"
                            class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-300"
                        >
                        {% else %}
                        <div class="flex items-center justify-center w-full h-full bg-gradient-to-br from-primary-500 to-accent-500">
                            <span class="text-4xl font-bold text-white">{{ brand.name | first | upper }}</span>
                        </div>
                        {% endif %}
                    </div>
                    
                    <div class="p-6 space-y-3">
                        <h3 class="text-xl font-bold text-gray-900 group-hover:text-primary-600 transition-colors duration-200">{{ brand.name }}</h3>
                        {% if brand.description %}
                        <p class="text-sm text-gray-600 line-clamp-2">{{ brand.description | truncate(100) }}</p>
                        {% endif %}
                    </div>
                </a>
            </article>
            {% endfor %}
        </div>

        {# Pagination #}
        {% if pagination and (pagination.has_next or pagination.has_previous) %}
        <nav class="flex items-center justify-between border-t border-gray-200 pt-8 mt-12" aria-label="Brands pagination">
            <div class="text-sm text-gray-600">
                Showing {{ ((pagination.current - 1) * pagination.size) + 1 }} - 
                {{ (pagination.current * pagination.size) | min(pagination.item_total) }} 
                of {{ pagination.item_total }} brands
            </div>
            
            <div class="flex items-center space-x-4">
                {% if pagination.has_previous %}
                <a href="?page={{ pagination.current - 1 }}{{ ('&search=' + searchQuery) if searchQuery else '' }}" 
                   class="btn-tw-outline">
                    ← Previous
                </a>
                {% endif %}
                
                <span class="px-4 py-2 text-sm font-medium text-gray-700">Page {{ pagination.current }}</span>
                
                {% if pagination.has_next %}
                <a href="?page={{ pagination.current + 1 }}{{ ('&search=' + searchQuery) if searchQuery else '' }}" 
                   class="btn-tw-primary">
                    Next →
                </a>
                {% endif %}
            </div>
        </nav>
        {% endif %}

        {% else %}
        {# Empty State #}
        <div class="text-center py-16">
            <div class="flex justify-center mb-6">
                <svg class="w-16 h-16 text-gray-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"></circle>
                    <path d="m21 21-4.35-4.35"></path>
                </svg>
            </div>
            <h2 class="text-3xl font-bold text-gray-900 mb-4">
                {% if searchQuery %}
                No Brands Found
                {% else %}
                No Brands Available
                {% endif %}
            </h2>
            <p class="text-lg text-gray-600 mb-8 max-w-md mx-auto">
                {% if searchQuery %}
                No brands found for "{{ searchQuery }}". Try a different search term.
                {% else %}
                We're working on adding brands. Check back soon!
                {% endif %}
            </p>
            <div class="flex justify-center space-x-4">
                {% if searchQuery %}
                <a href="/brands" class="btn-tw-primary">View All Brands</a>
                {% else %}
                <a href="/products" class="btn-tw-primary">Browse All Products</a>
                {% endif %}
            </div>
        </div>
        {% endif %}

        {# Statistics Section #}
        {% if brands and brands.length > 0 %}
        <section class="bg-white rounded-2xl p-8 my-16 shadow-soft">
            <div class="grid grid-cols-1 sm:grid-cols-3 gap-6 text-center">
                <div class="space-y-2">
                    <div class="text-3xl font-bold text-primary-600">{{ pagination.item_total | default(brands.length) }}</div>
                    <div class="text-sm text-gray-500 uppercase tracking-wide">Total Brands</div>
                </div>
                <div class="space-y-2">
                    <div class="text-3xl font-bold text-primary-600">{{ brands.length }}</div>
                    <div class="text-sm text-gray-500 uppercase tracking-wide">Showing</div>
                </div>
                <div class="space-y-2">
                    <div class="text-3xl font-bold text-primary-600">{{ pagination.current | default(1) }}</div>
                    <div class="text-sm text-gray-500 uppercase tracking-wide">Page</div>
                </div>
            </div>
        </section>
        {% endif %}

        {# Call to Action #}
        <section class="text-center mt-16 py-16 bg-gradient-to-r from-primary-600 to-accent-600 rounded-2xl text-white">
            <h2 class="text-3xl md:text-4xl font-bold mb-6">Explore Products by Brand</h2>
            <p class="text-xl text-primary-100 mb-8 max-w-2xl mx-auto">
                Find products from your favorite brands or discover new ones in our complete collection.
            </p>
            <div class="flex flex-col sm:flex-row justify-center items-center space-y-4 sm:space-y-0 sm:space-x-6">
                <a href="/products" class="bg-white text-primary-600 px-8 py-3 rounded-xl font-semibold hover:bg-gray-100 transition-colors duration-200 transform hover:scale-105">Browse All Products</a>
                <a href="/categories" class="border-2 border-white text-white px-8 py-3 rounded-xl font-semibold hover:bg-white hover:text-primary-600 transition-all duration-200">View Categories</a>
            </div>
        </section>
    </div>
</div>
{% endblock %}
